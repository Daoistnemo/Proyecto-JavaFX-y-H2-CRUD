-- Eliminar tablas si ya existen
DROP TABLE IF EXISTS "PUBLIC"."CLIENTES";
DROP TABLE IF EXISTS "PUBLIC"."CONEXIONES";
DROP TABLE IF EXISTS "PUBLIC"."PEDIDOS";
DROP TABLE IF EXISTS "PUBLIC"."DETALLE_PEDIDO";

-- Crear tabla CLIENTES
CREATE CACHED TABLE "PUBLIC"."CLIENTES"(
    "ID" INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "NOMBRE" CHARACTER VARYING(100),
    "DIRECCION" CHARACTER VARYING(255),
    "TELEFONO" CHARACTER VARYING(20),
    "EMAIL" CHARACTER VARYING(100),
    "FECHA_REGISTRO" TIMESTAMP,
    PRIMARY KEY ("ID")
);



-- Crear tabla CONEXIONES
CREATE CACHED TABLE "PUBLIC"."CONEXIONES"(
    "ID" INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "NOMBRE_CONEXION" CHARACTER VARYING(100),
    "TIPO_CONEXION" CHARACTER VARYING(50),
    "MEDIDAS_CORTE" CHARACTER VARYING(100),
    "MEDIDAS_CAMPANAS" CHARACTER VARYING(100),
    "MEDIDAS_DE_CORTE_DE_SALIDAS" CHARACTER VARYING(100),
    "MEDIDAS_DE_CAMPANAS_DE_SALIDAS" CHARACTER VARYING(100),
    "TIPO_USO" CHARACTER VARYING(20) NOT NULL,
    "PRECIO" DECIMAL(10, 2),
    PRIMARY KEY ("ID")
);

-- Crear tabla PEDIDOS
CREATE CACHED TABLE "PUBLIC"."PEDIDOS"(
    "ID_PEDIDO" INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "ESTADO_PEDIDO" CHARACTER VARYING(50),
    "OBSERVACIONES" CHARACTER VARYING,
    "PRECIO_TOTAL" DECIMAL(10, 2),
    "CLIENTE" CHARACTER VARYING(50),
    "FECHA_PEDIDO" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("ID_PEDIDO")
);


-- Crear tabla DETALLE_PEDIDO
CREATE CACHED TABLE "PUBLIC"."DETALLE_PEDIDO"(
    "ID_DETALLE" INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "ID_PEDIDO" INT NOT NULL, -- Relación con la tabla PEDIDOS
    "ID_CONEXION" INT NOT NULL, -- Relación con la tabla CONEXIONES
    "CANTIDAD" INT NOT NULL,    -- Cantidad del producto
    "PRECIO_UNITARIO" DECIMAL(10, 2), -- Precio de la unidad del producto
    "TOTAL" DECIMAL(10, 2),          -- Total por ese producto (Cantidad * Precio Unitario)
    PRIMARY KEY ("ID_DETALLE"),
    FOREIGN KEY ("ID_PEDIDO") REFERENCES "PUBLIC"."PEDIDOS"("ID_PEDIDO"),
    FOREIGN KEY ("ID_CONEXION") REFERENCES "PUBLIC"."CONEXIONES"("ID")
);


